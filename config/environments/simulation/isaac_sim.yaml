# Isaac Sim仿真环境配置
# 集成Brain系统的仿真配置

# 仿真环境基础配置
simulation:
  # 仿真模式
  mode: "headless"  # headless, gui, render

  # 核心设置
  physics_engine: "physx"
  stage_units: "meters"
  enable_ros: false
  real_time: false

  # 时间配置
  physics_dt: 0.016666  # 60Hz
  rendering_dt: 0.016666  # 60Hz
  max_time: -1  # 无限制

  # 物理参数
  gravity: [0.0, 0.0, -9.81]

# Brain系统集成配置
brain_integration:
  # 话题映射
  topic_mapping:
    # 命令话题
    cmd_vel: "/isaac/cmd_vel"
    cmd_pose: "/isaac/cmd_pose"

    # 传感器话题
    rgb_image: "/isaac/camera/rgb"
    depth_image: "/isaac/camera/depth"
    pointcloud: "/isaac/lidar/points"
    odom: "/isaac/odom"
    imu: "/isaac/imu/data"

    # 状态话题
    robot_state: "/isaac/robot_state"
    simulation_time: "/isaac/simulation_time"

# 预设场景配置
presets:
  # 室内场景
  indoor:
    name: "Indoor Environment"
    description: "室内导航和操作场景"

    # 场景设置
    environment:
      lighting: "indoor"
      floor_size: [10.0, 10.0]
      wall_height: 3.0

    # 对象配置
    objects:
      - type: "table"
        position: [0.0, 0.0, 0.8]
        size: [1.5, 0.8, 0.8]

      - type: "chair"
        position: [2.0, 0.0, 0.5]
        count: 4

      - type: "obstacle"
        type: "cylinder"
        position: [-1.5, 1.5, 0.5]
        radius: 0.2
        height: 1.0

  # 室外场景
  outdoor:
    name: "Outdoor Environment"
    description: "室外导航场景"

    # 场景设置
    environment:
      lighting: "outdoor"
      terrain_size: [50.0, 50.0]
      terrain_type: "flat"  # flat, hills, uneven

    # 对象配置
    objects:
      - type: "tree"
        count: 10
        distribution: "random"

      - type: "building"
        count: 5
        distribution: "grid"

      - type: "road"
        width: 3.0
        pattern: "grid"

# 机器人预设配置
robot_presets:
  # UGV机器人
  ugv:
    name: "UGV Robot"
    usd_path: "/Isaac/Robots/MobileRobots/ClearpathHusky/husky.usd"

    # 物理参数
    physics:
      mass: 50.0  # kg
      wheels:
        radius: 0.1651  # m
        width: 0.1      # m
        suspension:
          travel: 0.1   # m
          stiffness: 10000.0  # N/m
          damping: 1000.0     # Ns/m

    # 初始位姿
    initial_pose:
      position: [0.0, 0.0, 0.5]
      orientation: [0.0, 0.0, 0.0, 1.0]

    # 传感器配置
    sensors:
      - type: "camera"
        name: "front_camera"
        position: [0.5, 0.0, 0.8]
        orientation: [0.0, 0.0, 0.0]

      - type: "lidar"
        name: "top_lidar"
        position: [0.0, 0.0, 1.2]
        orientation: [0.0, 0.0, 0.0]
        horizontal_fov: 360
        range: 30.0

      - type: "imu"
        name: "main_imu"
        position: [0.0, 0.0, 0.3]
        orientation: [0.0, 0.0, 0.0]

  # 四旋翼无人机
  quadrotor:
    name: "Quadrotor UAV"
    usd_path: "/Isaac/Robots/Quadrotor/quadrotor.usd"

    # 物理参数
    physics:
      mass: 1.5  # kg
      arm_length: 0.25  # m
      rotor_radius: 0.15  # m
      max_thrust: 25.0  # N
      max_torque: 2.5  # N*m

    # 初始位姿
    initial_pose:
      position: [0.0, 0.0, 2.0]
      orientation: [0.0, 0.0, 0.0, 1.0]

    # 传感器配置
    sensors:
      - type: "camera"
        name: "bottom_camera"
        position: [0.0, 0.0, -0.1]
        orientation: [0.7071, 0.0, 0.0, -0.7071]

      - type: "imu"
        name: "flight_controller"
        position: [0.0, 0.0, 0.0]
        orientation: [0.0, 0.0, 0.0]

# 任务场景配置
task_scenarios:
  # 导航任务
  navigation:
    name: "Autonomous Navigation"
    description: "自主导航到目标点"

    # 场景配置
    environment: "outdoor"
    robot: "ugv"

    # 任务配置
    task:
      type: "point_to_point"
      waypoints:
        - [5.0, 5.0]
        - [10.0, 10.0]
        - [5.0, 15.0]
        - [0.0, 0.0]

      # 时间限制
      time_limit: 300  # seconds

      # 成功条件
      success_criteria:
        distance_threshold: 0.5  # meters
        all_waypoints: true

  # 探索任务
  exploration:
    name: "Environment Exploration"
    description: "未知环境探索"

    # 场景配置
    environment: "indoor"
    robot: "ugv"

    # 任务配置
    task:
      type: "exploration"
      exploration_area: [10.0, 10.0]  # meters
      coverage_threshold: 0.8  # 80% coverage
      time_limit: 600  # seconds

  # 巡航任务
  patrol:
    name: "Area Patrol"
    description: "区域巡航监控"

    # 场景配置
    environment: "outdoor"
    robot: "quadrotor"

    # 任务配置
    task:
      type: "patrol"
      patrol_area: [20.0, 20.0]  # meters
      flight_height: 5.0  # meters
      flight_speed: 2.0  # m/s
      time_limit: 900  # seconds

# 数据记录配置
data_recording:
  enabled: true
  output_directory: "./data/simulation"

  # 记录数据类型
  record_types:
    - "robot_states"
    - "sensor_data"
    - "simulation_time"
    - "object_poses"
    - "collision_events"

  # 记录频率
  frequency: 30  # Hz

  # 文件格式
  format: "hdf5"
  compression: true

  # 自动清理
  auto_cleanup:
    enabled: true
    max_storage_gb: 10
    retention_days: 7

# 调试和可视化
debug:
  # 启用调试功能
  enabled: true

  # 可视化选项
  visualization:
    show_coordinates: true
    show_collision_shapes: true
    show_sensor_frustums: true
    show_trajectory: true

  # 性能监控
  performance:
    enable_profiling: true
    log_fps: true
    log_physics_time: true

  # 日志级别
  log_level: "INFO"